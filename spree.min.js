!function(e,t){function n(){function n(t){var n=e.getComputedStyle(t),o=+n.paddingLeft.slice(0,-2),r=+n.borderLeft.split(" ")[0].slice(0,-2),i=+n.marginLeft.slice(0,-2);H="margin-left:"+(o+r+i-13)+"px;padding-left:10px;border-left:3px solid "+j[J]+";"}function o(e,n){var o=e===K,i=e.length/3>>0,a=t.createElement("span"),s=t.createElement("span"),l=t.createElement("span"),d=t.createElement("div");a.style.float="right",s.className="spreeText",d.className="spreeaftwrap",o?s.innerText=e:(a.innerText=e.slice(0,i),s.innerText=e[i],l.innerText=e.slice(i+1)),d.appendChild(s),d.appendChild(l),n.innerHTML="",n.appendChild(d),n.appendChild(a);var p=s.offsetWidth/-2;s.style.marginLeft=p+"px",a.style.marginRight=-p+"px",o&&r(0)}function r(e){Y?(Y=0,e&&w(),r.func()):(Y=1,e&&m())}function i(e){var t=z/5;38===e?z-=t:z+=t,10>z&&(z=10),chrome.storage.sync.set({gap:z});var n=6e4/(z+50);g(n)}function a(){B-=10,0>B&&(B=0)}function s(e){for(var t,n,o=0,r=10,i=e.length;i>o;o+=10,r+=10)n=e.slice(o,r),i>r&&(n+="-"),0===o?t=n:O.push(n);return t}function l(e){if(l.arr.push(e),50===l.arr.length){for(var t=0,n=0;50>n;n++)t+=l.arr[n];g(6e4/(t/50)),l.arr.length=0}}function d(e,n){if(e)return P.appendChild(e),e;var o=t.createElement("div");for(var r in n)n.hasOwnProperty(r)&&(o[r]=n[r]);return P.appendChild(o),o}function p(){var e=t.createElement("div");e.id="colorDiv",j.forEach(function(n){var o=t.createElement("div");o.className="spreeColor",o.style.backgroundColor=n,e.appendChild(o)}),D.appendChild(e),R=e.children,D.addEventListener("mouseover",c),D.addEventListener("mouseout",u),D.addEventListener("mousedown",h)}function f(e){if(-1!==e){var t=L.rules;t[17].style.color=j[e],t[8].style.backgroundColor=q[e],H=H.slice(0,-8)+j[e]+";",S&&(S.style.cssText=H)}}function c(e){f(W.call(R,e.target))}function u(e){e.toElement&&"spreeColor"===e.toElement.className||f(J)}function h(e){J=W.call(R,e.target),chrome.storage.sync.set({colorIndex:J})}function g(e){N.innerText="~"+e.toString().slice(0,6)+" wpm"}function x(e,t){return e===P||null===e?t:x(e.offsetParent,t+e.offsetTop)}function v(e,t){return e===P||null===e?t:v(e.offsetParent,t+e.offsetLeft)}function m(){var e=G[X],n=e.words,o=e.gaps,r=e.node;if(r){for(var i=r.parentNode,a=B-1,s=e.words[a],l=M,d=M,p=0;a>p;p++)l+=o[p]+n[p];for(l+=o[a],p=a+1;p<o.length;p++){var f=o[p];n[p]&&(f+=n[p]),d+=f}var c=t.createTextNode(l),u=t.createTextNode(d),h=t.createElement("span");h.className="spreeHL",h.innerText=s,i.insertBefore(c,r),i.insertBefore(h,r),i.insertBefore(u,r),i.removeChild(r)}}function w(){var e=t.getElementsByClassName("spreeHL")[0];if(e){var n=e.previousSibling,o=e.nextSibling,r=G[X].node,i=e.parentNode;i.insertBefore(r,n),i.removeChild(n),i.removeChild(e),i.removeChild(o)}}function C(e){var t=e.tagName;if("PRE"==t&&G.push({words:[K],gaps:["",""],node:e}),"IMG"!=t&&"SCRIPT"!=t&&"EMBED"!=t&&"PRE"!=t&&"VIDEO"!=t&&"TABLE"!=t&&"FORM"!=t&&"FIGURE"!=t){var n=e.childNodes,o=n.length;if(o)for(var r=0;o>r;r++)C(n[r]);else 3===e.nodeType&&G.push({words:e.nodeValue.split(/\s+/),gaps:e.nodeValue.split(/\S+/),node:e})}}function T(t,n){var i=t.nextElementSibling;if(C(t),!G.length)return i?setTimeout(function(){T(i,n)}):void 0;U=G.length-1;var a=G[X].words,d=a.length;B=0,S=t,t.offsetTop+t.clientHeight+V>y+e.scrollY&&e.scrollTo(0,t.offsetTop+V-50),A=t.style.cssText,t.style.cssText=H,function p(){if(!I){if(Y)return r.func=p,void 0;if(U>X||d>B||O.length){var e,t=0;if(O.length?e=O.shift():(B===d&&(a=G[++X].words,d=a.length,B=0),e=a[B++]),e.length>20&&(e=s(e)),e.length){o(e,n);var f=e[0],c=e[e.length-1];f===f.toUpperCase()&&(t+=z/1.5),","===c||";"===c?t+=z/5:("."===c||"?"===c||"!"===c)&&(t+=z/2.5)}var u=z+t+8*e.length;l(u),setTimeout(p,u)}else b(),i&&setTimeout(function(){T(i,n)})}}()}function E(){S.style.cssText=A}function b(){E(),S=null,G.length=0,X=0}var y,L,F,R,N,k,D,H,S,A,B=0,P=t.body,z=100,I=0,M="",O=[],V=0,W=Array.prototype.indexOf,Y=0,G=[],U=0,X=0,j=["#FFA500","#99793D","#FF6200","#40FFCE","#00FF76","#FFCF40","#1500FF","#773D99","#A000FF","#FF8700","#5E3D99","#444444","#00B5FF","#998B3D","#00F8FF","#FF0F26"],q=["#ffd530","#c9a96d","#ff9230","#70fffe","#30ffa6","#ffff70","#4530ff","#a76dc9","#d030ff","#ffb730","#8e6dc9","#747474","#30e5ff","#c9bb6d","#30ffff","#ff3f56"],J=0,K=" (code) ";chrome.storage.sync.get(null,function(e){e.gap&&(z=e.gap),e.colorIndex&&(J=e.colorIndex)}),r.func=function(){},l.arr=[],F=function(){var e=0,t=1;return function(n){t&&(p(),t=0),e||n?(k.innerText="Controls ▾",D.style.cssText="width:0;height:0;",e=0):(k.innerText="Controls ▴",D.style.cssText="width:140px;height:140px",e=1)}}(),e.addEventListener("mousedown",function(t){var o=t.target;if("HTML"!==o.tagName&&"SELECT"!==o.tagName&&(0===t.button||document.all&&1===t.button)){var s=t.pageX,l=t.pageY,p=o.clientWidth,c=o.clientHeight;p||(p=o.offsetWidth,c=o.offsetHeight);var u=x(o,0),h=v(o,0);if(s-h>p||l-u>c)return;var m=setTimeout(function(){function t(){I=1,V=0,Y=0,w(),b(),F(1),P.removeChild(c),P.removeChild(N),P.removeChild(k),P.removeChild(D),e.removeEventListener("keydown",p),k.removeEventListener("mousedown",s)}function s(){F(0),e.addEventListener("mousedown",l)}function l(t){t.target!==k&&"spreeColor"!==t.target.className&&(F(1),e.removeEventListener("mousedown",l))}function p(e){e.preventDefault();var n=e.keyCode;return 38===n||40===n?i(n):32===n?r(1):37===n?a():(t(),void 0)}I=0,V=x(o.offsetParent,0),n(o),f(J),y=e.innerHeight;var c=d(c,{id:"spreeCon",className:"spreeAtop spreeText",innerHTML:"<div class='spreeaftwrap'><span class='spreeText' style='margin-left:-50px'>Spree...</span></div>"});k=d(k,{id:"spreeControls",className:"spreeAtop spreeText",innerText:"Controls ▾"}),D=d(D,{id:"spreeControlPane",className:"spreeAtop spreeText"}),N=d(N,{id:"spreewpm",className:"spreeAtop spreeText"}),g(6e4/(z+50)),setTimeout(function(){T(o,c)},500),e.addEventListener("keydown",p),k.addEventListener("mousedown",s)},1e3),C=function(){clearTimeout(m),e.removeEventListener("mouseup",C),e.removeEventListener("mousemove",E)},E=function(t){var n=t.pageX-s,o=t.pageY-l;(n>10||-10>n||o>10||-10>o)&&(clearTimeout(m),e.removeEventListener("mousemove",E))};e.addEventListener("mouseup",C),e.addEventListener("mousemove",E)}}),L=function(){var e=t.createElement("style");e.appendChild(t.createTextNode("")),t.head.appendChild(e);var n=e.sheet;return n.addRule("#spreeCon","color:#444;width:600px;height:100px;top:50%;left:50%;margin:-50px 0 0 -300px;box-shadow:0 4px 6px -4px #666, 0 1px 2px 0 #666;text-align:left;font-size:36px;line-height:100px;font-weight:300;padding:0;",0),n.addRule(".spreeaftwrap","float:right;font-size:36px;border:0;width:350px;line-height:100px;display:inline-block;background:#fffefc;",1),n.addRule(".spreeaftwrap >span","float:left;line-height:100px;font-size:36px;",2),n.addRule("#spreewpm","top:10px;left:10px;",3),n.addRule("#spreeControls","top:10px;right:10px;-webkit-touch-callout: none;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;",4),n.addRule("#spreeControls:hover","cursor:pointer",5),n.addRule(".spreeaftwrap>span:before",'content: "";border-left: 1px solid #666;height: 25px;position:absolute;left: 249px;',6),n.addRule(".spreeaftwrap>span:after",'content: "";border-left: 1px solid #666;height: 25px;position:absolute;left: 249px;bottom:0px;',7),n.addRule(".spreeHL","background-color:#ffd530;",8),n.insertRule("@media screen and (max-width : 600px){.spreeCon{margin:-50px 0 0 0; width:100%;left:0}.spreeaftwrap{width:60%;}.spreeaftwrap>span:before,.spreeaftwrap>span:after{left:39.4%;}}",9),n.addRule(".spreeCon >span","line-height:100px",10),n.addRule("#spreeControlPane","top:33px;right:10px;width:0;height:0;overflow:hidden;padding:0;box-shadow:0px 2px 1px -1px #666;-webkit-transition: height 0.1s ease-out,width 0.1s ease-out;-moz-transition: height 0.1s ease-out,width 0.1s ease-out;-o-transition: height 0.1s ease-out,width 0.1s ease-out;transition: height 0.1s ease-out,width 0.1s ease-out;",11),n.addRule(".spreeAtop","position:fixed;background:#fffefc;text-align:center;box-shadow:0 1px 1px 0 #666;z-index:591233;padding:2px 4px;width:auto;height:auto;font-size:14px;font-family:Helvetica;",12),n.addRule(".spreeColor","width:35px;height:35px;float:left;",13),n.addRule("#colorDiv","width:140px;height:140px;background:#fffefc;float:right;margin:0;padding:0;border:0;",14),n.addRule("#colorDiv:hover","cursor:pointer;",15),n.addRule(".spreeColor:active","opacity:0.7",16),n.addRule(".spreeText","color:#ffa500;",17),n}()}"loaded"===t.readyState||"complete"===t.readyState?n():e.addEventListener("DOMContentLoaded",n)}(window,document);