!function(a,b){function c(){function c(){E=n({id:"spreeCon",className:"spreeAtop spreeText",innerHTML:Y}),G=n({id:"spreeControls",className:"spreeAtop spreeText",innerText:"Controls ▾"}),H=n({id:"spreeControlPane",className:"spreeAtop spreeText"}),I=n({id:"spreewpm",className:"spreeAtop spreeText"})}function d(a){return N.appendChild(a),a}function e(b){var c=a.getComputedStyle(b),d=+c.paddingLeft.slice(0,-2),e=+c.borderLeft.split(" ")[0].slice(0,-2),f=+c.marginLeft.slice(0,-2);K="margin-left:"+(d+e+f-13)+"px;padding-left:10px;border-left:3px solid "+Z[R]+";"}function f(a){if(-1!==a){var b=cb.rules;b[17].style.color=Z[a],b[8].style.backgroundColor=$[a],K=K.slice(0,-8)+Z[a]+";",F&&(F.style.cssText=K)}}function g(b,c){w(b);var d=b.nextElementSibling;if(!W.length)return d?setTimeout(function(){g(d,c)}):void 0;var e=W.length-1,f=W[S].words,j=f.length;O=0,F=b,L=b.style.cssText,b.style.cssText=K,b.offsetTop+b.clientHeight+Q>M+a.scrollY&&a.scrollTo(0,b.offsetTop+Q-50),function k(){if(!V){if(U)return void(i.callback=k);if(e>S||j>O||X.length){var a,b=0;if(X.length?a=X.shift():(O===j&&(f=W[++S].words,j=f.length,O=0),a=f[O++]),a.length>20&&(a=l(a)),a.length){h(a,c);var n=a[0],o=a[a.length-1];n===n.toUpperCase()&&(b+=P/1.5),","===o||";"===o?b+=P/5:("."===o||"?"===o||"!"===o)&&(b+=P/2.5)}var p=P+b+8*a.length;m(p),setTimeout(k,p)}else z(),d&&setTimeout(function(){g(d,c)},0)}}()}function h(a,c){var d=a===_,e=a.length/3>>0,f=b.createElement("span"),g=b.createElement("span"),h=b.createElement("span"),j=b.createElement("div");f.style.float="right",g.className="spreeText",j.className="spreeaftwrap",d?g.innerText=a:(f.innerText=a.slice(0,e),g.innerText=a[e],h.innerText=a.slice(e+1)),j.appendChild(g),j.appendChild(h),c.innerHTML="",c.appendChild(j),c.appendChild(f);var k=g.offsetWidth/-2;g.style.marginLeft=k+"px",f.style.marginRight=-k+"px",d&&i(0)}function i(a){U?(U=0,a&&v(),i.callback()):(U=1,a&&u())}function j(a){var b=P/5;38===a?P-=b:P+=b,10>P&&(P=10),chrome&&chrome.storage&&chrome.storage.sync.set({gap:P});var c=6e4/(P+50);s(c)}function k(){O-=10,0>O&&(O=0)}function l(a){for(var b,c,d=0,e=10,f=a.length;f>d;d+=10,e+=10)c=a.slice(d,e),f>e&&(c+="-"),0===d?b=c:X.push(c);return b}function m(a){if(m.arr.push(a),50===m.arr.length){for(var b=0,c=0;50>c;c++)b+=m.arr[c];s(6e4/(b/50)),m.arr.length=0}}function n(a){var c=b.createElement("div");for(var d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);return N.appendChild(c),c}function o(){var a=b.createElement("div");a.id="colorDiv",Z.forEach(function(c){var d=b.createElement("div");d.className="spreeColor",d.style.backgroundColor=c,a.appendChild(d)}),H.appendChild(a),J=a.children,H.addEventListener("mouseover",p),H.addEventListener("mouseout",q),H.addEventListener("mousedown",r)}function p(a){f(ab.call(J,a.target))}function q(a){a.toElement&&"spreeColor"===a.toElement.className||f(R)}function r(a){R=ab.call(J,a.target),chrome&&chrome.storage&&chrome.storage.sync.set({colorIndex:R})}function s(a){I.innerText="~"+a.toString().slice(0,6)+" wpm"}function t(a,b){return a===N||null===a?b:t(a.offsetParent,b+a.offsetTop)}function u(){var a=W[S];if(a){var c=a.words,d=a.gaps,e=a.node;if(e){for(var f=e.parentNode,g=O-1,h=a.words[g],i="",j="",k=0;g>k;k++)i+=d[k]+c[k];for(i+=d[g],k=g+1;k<d.length;k++){var l=d[k];c[k]&&(l+=c[k]),j+=l}var m=b.createTextNode(i),n=b.createTextNode(j),o=b.createElement("span");o.className="spreeHL",o.innerText=h,f.insertBefore(m,e),f.insertBefore(o,e),f.insertBefore(n,e),f.removeChild(e)}}}function v(){var a=b.getElementsByClassName("spreeHL")[0];if(a){var c=a.previousSibling,d=a.nextSibling,e=W[S].node,f=a.parentNode;f.insertBefore(e,c),f.removeChild(c),f.removeChild(a),f.removeChild(d)}}function w(a){var b=a.tagName;if("PRE"==b&&W.push({words:[_],gaps:["",""],node:a}),"IMG"!=b&&"SCRIPT"!=b&&"EMBED"!=b&&"PRE"!=b&&"VIDEO"!=b&&"TABLE"!=b&&"FORM"!=b&&"FIGURE"!=b){var c=a.childNodes,d=c.length;if(d)for(var e=0;d>e;e++)w(c[e]);else 3===a.nodeType&&W.push({words:a.nodeValue.split(/\s+/),gaps:a.nodeValue.split(/\S+/),node:a})}}function x(){F&&(F.style.cssText=L)}function y(){E.innerHTML="<div class='spreeaftwrap'><span class='spreeText' style='margin-left:-50px'>Spree...</span></div>"}function z(){x(),F=null,W.length=0,S=0}function A(){V=1,T=0,Q=0,U=0,v(),z(),y(),bb(1),N.removeChild(E),N.removeChild(I),N.removeChild(G),N.removeChild(H),E.innerHTML=Y,a.removeEventListener("keydown",D),G.removeEventListener("mousedown",B)}function B(){bb(0),a.addEventListener("mousedown",C)}function C(b){b.target!==G&&"spreeColor"!==b.target.className&&(bb(1),a.removeEventListener("mousedown",C))}function D(a){a.preventDefault();var b=a.keyCode;if(18!==b)return 38===b||40===b?j(b):32===b?i(1):37===b?k():void A()}var E,F,G,H,I,J,K,L,M,N=b.body,O=0,P=100,Q=0,R=0,S=0,T=0,U=0,V=0,W=[],X=[],Y="<div class='spreeaftwrap'><span class='spreeText' style='margin-left:-50px'>Spree...</span></div>",Z=["#FFA500","#99793D","#FF6200","#40FFCE","#00FF76","#FFCF40","#1500FF","#773D99","#A000FF","#FF8700","#5E3D99","#444444","#00B5FF","#998B3D","#00F8FF","#FF0F26"],$=["#ffd530","#c9a96d","#ff9230","#70fffe","#30ffa6","#ffff70","#4530ff","#a76dc9","#d030ff","#ffb730","#8e6dc9","#747474","#30e5ff","#c9bb6d","#30ffff","#ff3f56"],_=" (code) ",ab=Array.prototype.indexOf,bb=function(){var a=0,b=1;return function(c){b&&(o(),b=0),a||c?(G.innerText="Controls ▾",H.style.cssText="width:0;height:0;",a=0):(G.innerText="Controls ▴",H.style.cssText="width:140px;height:140px",a=1)}}(),cb=function(){var a=b.createElement("style");a.appendChild(b.createTextNode("")),b.head.appendChild(a);var c=a.sheet;return c.addRule("#spreeCon","color:#444;width:600px;height:100px;top:50%;left:50%;margin:-50px 0 0 -300px;box-shadow:0 4px 6px -4px #666, 0 1px 2px 0 #666;text-align:left;font-size:36px;line-height:100px;font-weight:300;padding:0;",0),c.addRule(".spreeaftwrap","float:right;font-size:36px;border:0;width:350px;line-height:100px;display:inline-block;background:#fffefc;",1),c.addRule(".spreeaftwrap >span","float:left;line-height:100px;font-size:36px;",2),c.addRule("#spreewpm","top:10px;left:10px;",3),c.addRule("#spreeControls","top:10px;right:10px;-webkit-touch-callout: none;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;",4),c.addRule("#spreeControls:hover","cursor:pointer",5),c.addRule(".spreeaftwrap>span:before",'content: "";border-left: 2px solid transparent;border-right:2px solid transparent; border-top:25px solid #666;height: 0;width:0;position:absolute;left: 247px;',6),c.addRule(".spreeaftwrap>span:after",'content: "";border-left: 2px solid transparent;border-right:2px solid transparent; border-bottom:25px solid #666;height:0;width:0;position:absolute;left: 248px;bottom:0px;',7),c.addRule(".spreeHL","background-color:#ffd530;",8),c.insertRule("@media screen and (max-width : 600px){.spreeCon{margin:-50px 0 0 0; width:100%;left:0}.spreeaftwrap{width:60%;}.spreeaftwrap>span:before,.spreeaftwrap>span:after{left:39.4%;}}",9),c.addRule(".spreeCon >span","line-height:100px",10),c.addRule("#spreeControlPane","top:33px;right:10px;width:0;height:0;overflow:hidden;padding:0;box-shadow:0px 2px 1px -1px #666;-webkit-transition: height 0.1s ease-out,width 0.1s ease-out;-moz-transition: height 0.1s ease-out,width 0.1s ease-out;-o-transition: height 0.1s ease-out,width 0.1s ease-out;transition: height 0.1s ease-out,width 0.1s ease-out;",11),c.addRule(".spreeAtop","position:fixed;background:#fffefc;text-align:center;box-shadow:0 1px 1px 0 #666;z-index:591233;padding:2px 4px;width:auto;height:auto;font-size:14px;font-family:Helvetica;",12),c.addRule(".spreeColor","width:35px;height:35px;float:left;",13),c.addRule("#colorDiv","width:140px;height:140px;background:#fffefc;float:right;margin:0;padding:0;border:0;",14),c.addRule("#colorDiv:hover","cursor:pointer;",15),c.addRule(".spreeColor:active","opacity:0.7",16),c.addRule(".spreeText","color:#ffa500;",17),c}();chrome&&chrome.storage&&chrome.storage.sync.get(null,function(a){a.gap&&(P=a.gap),a.colorIndex&&(R=a.colorIndex)}),a.addEventListener("mousedown",function(b){var h=b.target,i=h.tagName;b.altKey===!0&&0===T&&"HTML"!==i&&"SELECT"!==i&&"INPUT"!==i&&"TEXTAREA"!==i&&(0===b.button||document.all&&1===b.button)&&(V=0,T=1,Q=t(h.offsetParent,0),M=a.innerHeight,e(h),f(R),E?(d(E),d(G),d(H),d(I)):c(),s(6e4/(P+50)),setTimeout(function(){g(h,E)},500),a.addEventListener("keydown",D),G.addEventListener("mousedown",B))}),i.callback=function(){},m.arr=[]}"loaded"===b.readyState||"complete"===b.readyState?c():a.addEventListener("DOMContentLoaded",c)}(window,document);